<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8YKDW6K6TJ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-8YKDW6K6TJ');
    </script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "ve1zidrv09");
    </script>
    <title>ì €ë… ë©”ë‰´ ì¶”ì²œ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body data-theme="light">
    <div id="top-right-controls">
        <button id="animal-test-nav-button">ë™ë¬¼ìƒ í…ŒìŠ¤íŠ¸</button>
        <div id="theme-toggle-container">
            <button id="theme-toggle"></button>
        </div>
        <div id="lang-toggle-container">
            <button id="lang-toggle">EN</button>
        </div>
    </div>
    <div id="main-content">
        <div id="home-view">
            <menu-recommender></menu-recommender>

            <section id="contact-section">
                <h2>ì œíœ´ ë¬¸ì˜</h2>
                <form action="https://formspree.io/f/mgolwlwb" method="POST" id="contact-form">
                    <div class="form-group">
                        <label for="email">Your email:</label>
                        <input type="email" name="email" id="email" required placeholder="example@email.com">
                    </div>
                    <div class="form-group">
                        <label for="message">Your message:</label>
                        <textarea name="message" id="message" required placeholder="ë¬¸ì˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
                    </div>
                    <button type="submit" id="form-submit-button">Send</button>
                </form>
            </section>

            <section id="comments-section">
                <div id="disqus_thread"></div>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>
        </div>

        <section id="animal-face-test-service" style="display: none;">
            <h2>AI ë™ë¬¼ìƒ í…ŒìŠ¤íŠ¸</h2>
            <p>ì–¼êµ´ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ë©´ AIê°€ ë‹®ì€ ë™ë¬¼ì„ ë¶„ì„í•´ë“œë¦½ë‹ˆë‹¤.</p>
            
            <div id="image-upload-container">
                <input type="file" id="image-upload-input" accept="image/*" style="display: none;">
                <div id="image-preview-container" onclick="document.getElementById('image-upload-input').click()">
                    <img id="image-preview" src="#" alt="ë¯¸ë¦¬ë³´ê¸°" style="display: none;">
                    <div id="upload-placeholder">
                        <span class="upload-icon">ğŸ“¸</span>
                        <span>í´ë¦­í•˜ì—¬ ì‚¬ì§„ ì—…ë¡œë“œ</span>
                    </div>
                </div>
            </div>

            <div id="loading-spinner" style="display: none;">
                <div class="spinner"></div>
                <p>AIê°€ ë‹¹ì‹ ì˜ ì–¼êµ´ì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>
            </div>

            <div id="label-container" style="display: none;"></div>
            <button id="back-to-home-button">ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
        </section>
    </div>
    <script src="main.js"></script>

    <!-- AI ëª¨ë¸ ë¡œë“œ (Teachable Machine) -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    <script type="text/javascript">
        const URL_TM = "https://teachablemachine.withgoogle.com/models/ayvkYNWsw/";
        let model, labelContainer, maxPredictions;

        async function loadModel() {
            try {
                const modelURL = URL_TM + "model.json";
                const metadataURL = URL_TM + "metadata.json";
                model = await tmImage.load(modelURL, metadataURL);
                maxPredictions = model.getTotalClasses();
                
                labelContainer = document.getElementById("label-container");
                labelContainer.innerHTML = ''; // Clear previous
                for (let i = 0; i < maxPredictions; i++) {
                    labelContainer.appendChild(document.createElement("div"));
                }
            } catch (e) {
                console.error("Model loading failed", e);
            }
        }

        async function predict() {
            const loading = document.getElementById("loading-spinner");
            const labels = document.getElementById("label-container");
            
            loading.style.display = 'block';
            labels.style.display = 'none';

            const image = document.getElementById("image-preview");
            
            // Give a small delay for better UX
            setTimeout(async () => {
                const prediction = await model.predict(image);
                
                // Sort predictions by probability
                prediction.sort((a, b) => b.probability - a.probability);

                for (let i = 0; i < maxPredictions; i++) {
                    const probability = (prediction[i].probability * 100).toFixed(0);
                    labelContainer.children[i].innerHTML = `
                        <div class="result-bar-container">
                            <div class="result-header">
                                <span class="result-label">${prediction[i].className}</span>
                                <span class="result-value">${probability}%</span>
                            </div>
                            <div class="result-bar-bg">
                                <div class="result-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    `;
                    // Trigger animation after a short delay
                    setTimeout(() => {
                        const bar = labelContainer.children[i].querySelector('.result-bar');
                        if (bar) bar.style.width = probability + '%';
                    }, 50 * i);
                }
                
                loading.style.display = 'none';
                labels.style.display = 'block';
            }, 800);
        }

        const input = document.getElementById('image-upload-input');
        input.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                const img = document.getElementById('image-preview');
                const placeholder = document.getElementById('upload-placeholder');
                
                img.src = event.target.result;
                img.style.display = 'block';
                placeholder.style.display = 'none';
                
                img.onload = () => predict();
            };
            reader.readAsDataURL(file);
        });

        window.addEventListener('DOMContentLoaded', loadModel);
    </script>
    <script>
        var disqus_config = function () {
            this.page.url = window.location.href.split('#')[0]; // Remove hash for canonical URL
            this.page.identifier = 'makeit_dinner_recommender'; 
        };
        (function() { 
            var d = document, s = d.createElement('script');
            s.src = 'https://makeit-1.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</body>
</html>

